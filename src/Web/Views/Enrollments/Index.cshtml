@using Web.Models
@model IEnumerable<Web.Models.EnrollmentViewModel>

@{
    ViewData["Title"] = "Inscripcions";
    
    // Configuraci√≥ de la taula gen√®rica per inscripcions
    var tableConfig = new TableViewModel<EnrollmentViewModel>
    {
        Data = Model,
        EntityName = "Inscripcions",
        ControllerName = "Enrollments",
        EmptyMessage = "No hi ha inscripcions registrades.",
        Columns = new List<ColumnConfig>
        {
            new ColumnConfig 
            { 
                PropertyName = "StudentName", 
                DisplayName = "Alumne",
                IsSortable = true 
            },
            new ColumnConfig 
            { 
                PropertyName = "AcademicYear", 
                DisplayName = "Curs acad√®mic",
                IsSortable = true 
            },
            new ColumnConfig 
            { 
                PropertyName = "Status", 
                DisplayName = "Estat",
                IsSortable = true,
                CustomRender = (item) => 
                {
                    var enrollment = item as EnrollmentViewModel;
                    var badgeClass = enrollment?.Status == "Active" ? "success" 
                                   : enrollment?.Status == "Cancelled" ? "danger" 
                                   : "secondary";
                    return $"<span class=\"badge bg-{badgeClass}\">{enrollment?.Status}</span>";
                }
            },
            new ColumnConfig 
            { 
                PropertyName = "EnrolledAt", 
                DisplayName = "Data inscripci√≥",
                Format = "dd/MM/yyyy",
                IsSortable = true 
            }
        },
        Actions = new List<TableAction>
        {
            new TableAction 
            { 
                ActionName = "Details", 
                DisplayText = "Detalls",
                CssClass = "btn-info",
                Icon = "üëÅÔ∏è"
            }
        }
    };
}

<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>Inscripcions</h2>
        <a asp-action="Create" class="btn btn-primary">
            <i class="bi bi-plus-lg"></i> Nova Inscripci√≥
        </a>
    </div>

    <div class="card">
        <div class="card-body">
            @await Component.InvokeAsync("GenericTable", tableConfig)
        </div>
    </div>
</div>
